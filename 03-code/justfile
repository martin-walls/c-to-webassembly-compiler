default:
    just --list

cloc:
    cloc . --by-file --force-lang=Rust,lalrpop --exclude-list-file=.gitignore

test *ARGS:
    ./testsuite.py {{ARGS}}

run WASM *ARGS:
    ./runtime/run.mjs {{WASM}} {{ARGS}}

compile SOURCE OUTPUT="module.wasm" LOG_LEVEL="": build
    RUST_LOG={{LOG_LEVEL}} ./target/debug/c_to_wasm_compiler {{SOURCE}} -o {{OUTPUT}} --optimise all

compile_nooptimise SOURCE OUTPUT="module.wasm" LOG_LEVEL="": build
    UST_LOG={{LOG_LEVEL}} ./target/debug/c_to_wasm_compiler {{SOURCE}} -o {{OUTPUT}} --optimise none

build:
    cargo build

objdump WASM:
    wasm-objdump {{WASM}} -d
