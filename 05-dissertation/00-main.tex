\documentclass[12pt, a4paper]{report}

\usepackage[nogeometry]{mrw}

\input{91-metadata.tex}

\graphicspath{{20-figures}}

\usepackage[margin=2cm]{geometry}

% For the bibliography
\usepackage{biblatex}
\addbibresource{90-references.bib}

% To generate the index
\usepackage{imakeidx}
\makeindex[intoc]

% For including the original project proposal
\usepackage{pdfpages}

% Needed for vertical alignment of signature
\usepackage[export]{adjustbox}

% Chapter title styling
\usepackage{titlesec}
\usepackage{calc}
\newlength{\ChapterNumberPadding}
\setlength{\ChapterNumberPadding}{0.6em}
\newcommand{\ChapterNumber}{\colorbox{white}{\hspace{\ChapterNumberPadding}\thechapter\hspace{\ChapterNumberPadding}}}
\titleformat{\chapter}[display]
  {\bfseries\Huge} % format
  {%
  \makebox[\linewidth/2 - \widthof{\ChapterNumber}/2][l]
  {\rule[\heightof{\thechapter}/2]{\linewidth}{1pt}}%
  \ChapterNumber%
  } % chapter number label
  {0pt} % separation
  {\centering} % before code
  [\vspace{-6pt}\rule{\linewidth}{1pt}] % after code
\titleformat{name=\chapter,numberless}[display]
  {\bfseries\Huge} % format
  {} % chapter number label
  {0pt} % separation
  {\rule[\heightof{\thechapter}/2]{\linewidth}{1pt}%
  \vspace{5pt}
  \centering} % before code
  [\vspace{-6pt}\rule{\linewidth}{1pt}] % after code
% spacing: left indent, above title, below title
\titlespacing*{\chapter}{0pt}{-30pt}{40pt}
\titlespacing*{name=\chapter,numberless}{0pt}{-68pt}{40pt}

\fancyhead[L]{\nouppercase\leftmark}
\fancyhead[R]{\nouppercase\rightmark}
\fancyfoot{}
\fancyfoot[C]{\thepage\ / \pageref{LastPage}}

\setlength{\parindent}{0pt}
\addtolength{\parskip}{1ex}
% slightly increase line spacing to be more readable
\renewcommand{\baselinestretch}{1.1}

\NewDocumentCommand{\Signature}{}{
  \includegraphics[width=2cm, valign=m]{00-signature.jpg}
}

% best loaded last in the preamble (according to https://www.overleaf.com/learn/latex/Multi-file_LaTeX_projects)
\usepackage{subfiles}

\begin{document}

\subfile{10-titlepage.tex}

\pagestyle{plain}

\subfile{11-declaration-of-originality.tex}

\subfile{12-proforma.tex}

\pagestyle{fancy}

\tableofcontents

\subfile{01-introduction}

\subfile{02-preparation}

\subfile{03-implementation}

\cite{emscripten}

\subfile{04-evaluation}

\subfile{05-conclusions}

\printbibliography

\printindex

% Start appendices
\appendix
% Show "Appendix X" instead of just "X"
\renewcommand{\ChapterNumber}{\colorbox{white}{\hspace{\ChapterNumberPadding}Appendix \thechapter\hspace{\ChapterNumberPadding}}}

\subfile{13-original-proposal.tex}

\end{document}

